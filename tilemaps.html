<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Adding many entities at once - Yaeger Tutorial - Creating Waterworld</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="A tutorial for Waterworld, a simple game based on Yaeger ">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="import.html"><strong aria-hidden="true">2.</strong> Importing the starter code</a></li><li class="chapter-item expanded "><a href="setup.html"><strong aria-hidden="true">3.</strong> Setting up a new game</a></li><li class="chapter-item expanded "><a href="first-scene.html"><strong aria-hidden="true">4.</strong> Creating the first Scene</a></li><li class="chapter-item expanded "><a href="level.html"><strong aria-hidden="true">5.</strong> Creating a level</a></li><li class="chapter-item expanded "><a href="dynamic-entities.html"><strong aria-hidden="true">6.</strong> Adding Dynamic Entities</a></li><li class="chapter-item expanded "><a href="player-controlled.html"><strong aria-hidden="true">7.</strong> Adding a player controlled Entity</a></li><li class="chapter-item expanded "><a href="interaction.html"><strong aria-hidden="true">8.</strong> Adding interaction through collision detection</a></li><li class="chapter-item expanded "><a href="more-entities.html"><strong aria-hidden="true">9.</strong> Adding more Entities and EntitySpawners</a></li><li class="chapter-item expanded "><a href="tilemaps.html" class="active"><strong aria-hidden="true">10.</strong> Adding many entities at once</a></li><li class="chapter-item expanded "><a href="further-challenges.html"><strong aria-hidden="true">11.</strong> Further challenges</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Yaeger Tutorial - Creating Waterworld</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/han-yaeger/yaeger-tutorial" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="adding-many-entities-at-once"><a class="header" href="#adding-many-entities-at-once">Adding many entities at once</a></h1>
<p>The Game Level needs a bit more decoration, so as the last step in this tutorial, we are going to add some coral. The
following four images are available:</p>
<ol>
<li>coral1.png: <img src="images/game/coral1.png" alt="Coral1" /></li>
<li>coral2.png:<img src="images/game/coral2.png" alt="Coral1" /></li>
<li>coral3.png: <img src="images/game/coral3.png" alt="Coral1" /></li>
<li>coral4.png: <img src="images/game/coral4.png" alt="Coral1" /></li>
</ol>
<p>We could just create new instances of <code>SpriteEntity</code> for each of the four Coral images and then use
<code>addEntity(YaegerEntity)</code> to add them to the Game Level. This would work, but it will be hard to add them in a nice
pattern to a Scene.</p>
<p>To facilitate this, Yaeger supplies a <code>Tile Map</code>, which is an Object with which you can create a two-dimensional
discrete map that represents the Scene, and then use the map to decide where to place the Entities. Yaeger will then
calculate the location, width and height of each Entity and place them on the Scene. You do still need to create new
instances of <code>SpriteEntity</code> for each of the four Coral images, but the rest will be handled by Yaeger.</p>
<h2 id="create-coral-entities"><a class="header" href="#create-coral-entities">Create Coral Entities</a></h2>
<p>Let's first create the four Coral Entities. They should extend <code>SpriteEntity</code> and their constructor should accept
the <code>Coordinate2D</code> as the first parameter and the <code>Size</code> as the second. Add them to the package
<code>com.github.hanyaeger.tutorial.entities.map</code>.</p>
<h2 id="create-a-tile-map-for-the-coral"><a class="header" href="#create-a-tile-map-for-the-coral">Create a Tile Map for the Coral</a></h2>
<p><img src="images/edit.png" alt="Edit" /> Create a class <code>CoralTileMap</code> that extends <code>TileMap</code> to the
package <code>com.github.hanyaeger.tutorial.entities.map</code>.</p>
<p>As you can see, <code>CoralTileMap</code> will need to implement two methods. The method <code>setupEntities()</code> will be used to register
the Entities that are to be used with the Tile Map. The method <code>defineMap()</code> should return a two dimensional array
of <code>int</code> values. This array is a map of the Scene and tells Yaeger where to place which Entity. In the next step we will
implement both methods.</p>
<h2 id="implement-the-coraltilemap"><a class="header" href="#implement-the-coraltilemap">Implement the <code>CoralTileMap</code></a></h2>
<p>The method <code>setupEntities()</code> should be used to register Entities on the Tile Map. From this method we should call
<code>addEntity(int, Class);</code>. As you can see, this method accepts an integer and a Class. So in this case, we should not add
an instance of an Entity, but its Class. Yaeger will then use this Class to create instances.</p>
<p><img src="images/edit.png" alt="Edit" /> Implement the method <code>setupEntities()</code> as shown below.</p>
<pre><code class="language-java">@Override
public void setupEntities(){
        addEntity(1,CoralOne.class);
        addEntity(2,CoralTwo.class);
        addEntity(3,CoralThree.class);
        addEntity(4,CoralFour.class);
        }
</code></pre>
<p>The Coral should be placed in the lower half of the Scene. For this we can use the method <code>defineMap()</code>. From this
method will return a two-dimensional array that represents the Scene. The int value 0 will mean no Entity is to be
placed. The other values are mapped on the Entities that are registered from the method setupEntities().</p>
<p><img src="images/edit.png" alt="Edit" /> Implement the method <code>defineMap()</code> as shown below.</p>
<pre><code class="language-java">@Override
public int[][]defineMap(){
        int[][]map={
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0},
        {0,0,0,0,3,0,0,0,2,0,0,0,0,0,0,0,0,2,0},
        {3,0,0,0,0,4,0,0,0,0,0,1,0,0,2,0,3,0,1},
        {0,0,2,4,0,0,1,0,0,0,0,0,0,3,0,4,0,0,0},
        {1,0,0,0,0,0,0,0,4,0,0,0,0,0,0,1,0,3,0},
        {2,3,1,0,0,2,0,0,0,0,3,1,0,2,0,0,0,1,4},
        };
        return map;
        }
</code></pre>
<h2 id="add-the-tile-map-to-the-game-scene"><a class="header" href="#add-the-tile-map-to-the-game-scene">Add the Tile Map to the Game Scene</a></h2>
<p>To be able to use the Tile Map, the Scene will need to implement the interface <code>TileMapContainer</code>. This will expose the
method <code>setupTileMaps()</code>, from which the Tile Maps can be added, by calling <code>addTileMap(TileMap);</code>. This last method
accepts a parameter of the type <code>TileMap</code>. So we can instantiate a new <code>CoralTileMap</code> and pass this as a parameter to
the method.</p>
<p><img src="images/edit.png" alt="Edit" /> Add the <code>CoralTileMap</code> to the Game Scene.</p>
<p><img src="images/play.png" alt="Run" /> Run the game. If you have done everything correctly, when going to Game Scene, you will likely be
greeted with the following exception:</p>
<pre><code class="language-text">Caused by: java.lang.IllegalAccessException: class com.github.hanyaeger.api.engine.entities.tilemap.TileFactory (in module hanyaeger.api) cannot access class com.github.hanyaeger.tutorial.entities.map.CoralThree (in module waterworld) because module waterworld does not export com.github.hanyaeger.tutorial.entities.map to module hanyaeger.api
	at java.base/jdk.internal.reflect.Reflection.newIllegalAccessException(Reflection.java:376)
	at java.base/java.lang.reflect.AccessibleObject.checkAccess(AccessibleObject.java:647)
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:490)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:481)
	at hanyaeger.api@2020.2021-beta2-SNAPSHOT/com.github.hanyaeger.api.engine.entities.tilemap.TileFactory.create(TileFactory.java:39)
</code></pre>
<p>Remember how we talked about the <em>Module Descriptor</em>? We are going to edit it, to make sure that Yaeger is allowed to
make instances of the Coral Entities. Since all those classes are in the
package <code>com.github.hanyaeger.tutorial.entities.map</code>, we have to export that package.</p>
<p><img src="images/edit.png" alt="Edit" /> Add the following line to the file <code>module-info.java</code>:</p>
<pre><code class="language-text">    exports com.github.hanyaeger.tutorial.entities.map;
</code></pre>
<p><img src="images/play.png" alt="Run" /> Run the game. Note how the tiles in your TileMap are scaled automatically.</p>
<h2 id="ensure-hanny-is-hindered-whenever-she-crosses-a-piece-of-coral"><a class="header" href="#ensure-hanny-is-hindered-whenever-she-crosses-a-piece-of-coral">Ensure Hanny is hindered whenever she crosses a piece of Coral</a></h2>
<p>Hanny can now still cross a piece of Coral. This can be easily resolved, using the <code>Collided</code> and <code>Collider</code>
interfaces. If the speed of Hanny is set to 0, whenever she collides with a piece of Coral, she will stop moving for
that Game World Update. Because this new speed is only applied after one Game World Update, she can still move, but very
slowly.</p>
<p><img src="images/edit.png" alt="Edit" /> Implement everything required to ensure Hanny cannot cross a piece of coral. Also make sure a bubble can
still cross them.</p>
<p><img src="images/game/game.png" alt="Waterwworld" /></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="more-entities.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="further-challenges.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="more-entities.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="further-challenges.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
